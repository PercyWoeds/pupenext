<%
   price = @customer ?
       p.customer_price_with_info(@customer.id) :
       p.customer_subcategory_price_with_info(@customer_subcategory)

   lyhytkuvaus = params[:lyhytkuvaus] && p.lyhytkuvaus.present? ?
       p.lyhytkuvaus.truncate(2500) :
       ''

   image = params[:product_image] && p.cover_image.present? ?
       Base64.encode64(p.cover_image.data) :
       ''

   kuvaus = params[:kuvaus] && p.kuvaus.present? ?
       p.kuvaus.truncate(2500) :
       ''
%>

<tr class="container">
  <td colspan="3" class="inner-table-container">
    <table>
      <tr>
        <td class="width-100">
          <strong><%= p.tuoteno %></strong>
        </td>
        <td>
          <strong><%= p.nimitys %></strong>
        </td>
        <td class="width-100">
          <%= number_to_currency(price[:hinta]) %>

          <% if price[:contract_price] %>
            <small>(<%= t('reports.customer_price_lists.report.contract_price') %>)</small>
          <% end %>
        </td>
      </tr>

      <% if lyhytkuvaus.present? %>
        <tr>
          <td colspan="5"><%= lyhytkuvaus %></td>
        </tr>
      <% end %>

      <% if image.present? || kuvaus.present? %>
        <tr>
          <% if image.present? %>
            <td>
              <img src="data:image/jpg;base64,<%= image %>"
                   style="width: 100%;"/>
            </td>
          <% end %>

          <td colspan="4"><%= kuvaus %></td>
        </tr>
      <% end %>
    </table>
  </td>
</tr>

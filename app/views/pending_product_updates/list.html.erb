<%= return_link t('pending_product_updates.index.header'), pending_product_updates_path %>

<br><br>

<% @products.each do |product| %>
  <%= render "administration/form_errors", resource: product %>
<% end %>

<div id='notice' class='hidden'></div>

<table width='900'>

<tr>
  <th width='100'>
    <%= t('.sku') %>
  </th>
  <th width='250'>
    <%= t('.label') %>
  </th>
  <th width='450'>
  </th>
</tr>

<% @products.each do |product| %>
  <tr class='rows aktiivi <%= cycle('', :tumma) %>'>
    <td class='ptop'>
      <%= product.tuoteno %>
    </td>

    <td class='ptop'>
      <%= product.nimitys %>
    </td>

    <td class='ptop pending_update'>
      <%= form_for product, url: pending_product_update_path(product.id), remote: true do |f| %>

        <div id='<%= "pending_updates_#{product.id}" %>'>
          <div class='notifications'>
          </div>

          <%= f.fields_for :pending_updates do |pending_update| %>
            <%= render 'pending_update_fields', f: pending_update %>
          <% end %>
        </div>

        <%= link_to_add_association t('.link_new'), f, :pending_updates,
            partial: 'pending_update_fields',
            data: {
              association_insertion_method: :append,
              association_insertion_node: "#pending_updates_#{product.id}"
            } %>

        <% hidden = product.pending_updates.present? ? '' : 'hidden' %>
        <%= f.submit t('.save'), class: "submit right #{hidden}" %>

      <% end %>
    </td>
  </tr>
<% end %>

</table>
